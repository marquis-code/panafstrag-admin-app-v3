import{_ as j}from"./BRg3fQDk.js";import{d as z,o as S,a as F,b as l,c as r,e,F as B,h as A,g,x as P,y as w,j as d,v as p,B as N,t as n,i as m,r as u,s as E,u as L,n as R}from"./Df4s53kg.js";import{u as K}from"./CHTJDVlQ.js";const H={class:"space-y-6"},Q={class:"flex items-center justify-between"},G={class:"flex gap-4 border-b border-gray-200"},I=["onClick"],O={class:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden"},J={key:0,class:"p-12 flex justify-center"},W={key:1,class:"w-full text-left border-collapse"},X={key:0},Y={class:"py-4 px-6 align-top"},Z={class:"font-bold text-sm"},ee={class:"inline-block mt-1 px-2 py-0.5 bg-gray-100 rounded text-[9px] font-bold uppercase tracking-wider text-gray-500"},te={class:"py-4 px-6 align-top max-w-xs"},se={class:"text-sm text-gray-700 line-clamp-3"},oe={key:0,class:"mt-2 flex flex-wrap gap-1"},ae={class:"py-4 px-6 align-top text-sm text-gray-600"},le={key:0},re={key:1},ne={class:"mt-1 text-xs text-gray-400"},ie={class:"py-4 px-6 align-top"},de=["onClick"],ue={class:"py-4 px-6 align-top text-right space-x-2"},pe=["onClick"],ce=["onClick"],ge={class:"space-y-4"},be={class:"grid grid-cols-2 gap-4"},ye={key:0},xe={key:1},ve={class:"grid grid-cols-2 gap-4"},ke={class:"py-4"},fe={class:"text-sm text-gray-600"},$e=z({__name:"bot-config",setup(we){const b=L(),y=K("auth_token"),h=u([]),C=u(!0),f=u("all"),x=u(!1),v=u(!1),k=u(!1),i=u(null),a=u({key:"",type:"faq",message:"",pagePath:"",keywords:"",quickReplies:"",delayMs:1e3,priority:10,isActive:!0}),_=E(()=>f.value==="all"?h.value:h.value.filter(o=>o.type===f.value)),$=async()=>{C.value=!0;try{const o=await $fetch(`${b.public.apiBase}/chat/bot-configs`,{headers:{Authorization:`Bearer ${y.value}`}});h.value=o||[]}catch(o){console.error("Failed to fetch bot configs",o)}finally{C.value=!1}};S(()=>{$()});const M=o=>{o?(k.value=!0,i.value=o,a.value={...o,keywords:o.keywords?.join(", ")||"",quickReplies:o.quickReplies?.join(", ")||""}):(k.value=!1,i.value=null,a.value={key:"",type:"faq",message:"",pagePath:"",keywords:"",quickReplies:"",delayMs:1e3,priority:10,isActive:!0}),x.value=!0},T=async()=>{try{const o={...a.value,keywords:a.value.keywords?a.value.keywords.split(",").map(t=>t.trim()).filter(Boolean):[],quickReplies:a.value.quickReplies?a.value.quickReplies.split(",").map(t=>t.trim()).filter(Boolean):[]};k.value&&i.value?await $fetch(`${b.public.apiBase}/chat/bot-configs/${i.value._id}`,{method:"PUT",headers:{Authorization:`Bearer ${y.value}`},body:o}):await $fetch(`${b.public.apiBase}/chat/bot-configs`,{method:"POST",headers:{Authorization:`Bearer ${y.value}`},body:o}),x.value=!1,$()}catch(o){console.error("Save failed",o)}},V=async o=>{try{await $fetch(`${b.public.apiBase}/chat/bot-configs/${o._id}`,{method:"PUT",headers:{Authorization:`Bearer ${y.value}`},body:{isActive:!o.isActive}}),o.isActive=!o.isActive}catch{}},D=o=>{i.value=o,v.value=!0},U=async()=>{if(i.value)try{await $fetch(`${b.public.apiBase}/chat/bot-configs/${i.value._id}`,{method:"DELETE",headers:{Authorization:`Bearer ${y.value}`}}),v.value=!1,$()}catch(o){console.error("Delete failed",o)}};return F({title:"Bot Configurations | Admin"}),(o,t)=>{const q=j;return l(),r("div",H,[e("div",Q,[t[13]||(t[13]=e("div",null,[e("h2",{class:"text-2xl font-black uppercase tracking-widest"},"Bot Configuration"),e("p",{class:"text-sm text-gray-500 mt-1"},"Manage automated chat greetings, FAQ responses, and page triggers.")],-1)),e("button",{onClick:t[0]||(t[0]=s=>M()),class:"px-6 py-3 bg-black text-white text-[10px] font-black uppercase tracking-widest hover:bg-gray-800 transition-all rounded-lg"}," Add Configuration ")]),e("div",G,[(l(),r(B,null,A(["all","greeting","page_trigger","faq","fallback"],s=>e("button",{key:s,onClick:c=>f.value=s,class:R(["px-4 py-3 text-[10px] font-black uppercase tracking-[0.15em] border-b-2 transition-all",f.value===s?"border-black text-black":"border-transparent text-gray-400 hover:text-black"])},n(s.replace("_"," ")),11,I)),64))]),e("div",O,[C.value?(l(),r("div",J,[...t[14]||(t[14]=[e("div",{class:"w-8 h-8 border-4 border-gray-200 border-t-black rounded-full animate-spin"},null,-1)])])):(l(),r("table",W,[t[20]||(t[20]=e("thead",null,[e("tr",{class:"bg-gray-50/50"},[e("th",{class:"py-4 px-6 text-[10px] font-black uppercase tracking-widest text-gray-400"},"Key / Type"),e("th",{class:"py-4 px-6 text-[10px] font-black uppercase tracking-widest text-gray-400"},"Message"),e("th",{class:"py-4 px-6 text-[10px] font-black uppercase tracking-widest text-gray-400"},"Triggers"),e("th",{class:"py-4 px-6 text-[10px] font-black uppercase tracking-widest text-gray-400"},"Status"),e("th",{class:"py-4 px-6 text-[10px] font-black uppercase tracking-widest text-gray-400 text-right"},"Actions")])],-1)),e("tbody",null,[_.value.length===0?(l(),r("tr",X,[...t[15]||(t[15]=[e("td",{colspan:"5",class:"py-8 px-6 text-center text-sm text-gray-500 italic"},"No configurations found.",-1)])])):g("",!0),(l(!0),r(B,null,A(_.value,s=>(l(),r("tr",{key:s._id,class:"border-t border-gray-50 hover:bg-gray-50/50 transition-colors"},[e("td",Y,[e("p",Z,n(s.key),1),e("span",ee,n(s.type),1)]),e("td",te,[e("p",se,n(s.message),1),s.quickReplies?.length?(l(),r("div",oe,[(l(!0),r(B,null,A(s.quickReplies,c=>(l(),r("span",{key:c,class:"px-1.5 py-0.5 bg-[#d9fdd3] text-[#075e54] text-[9px] font-semibold rounded-sm"},n(c),1))),128))])):g("",!0)]),e("td",ae,[s.type==="page_trigger"?(l(),r("div",le,[t[16]||(t[16]=e("span",{class:"font-semibold"},"Path:",-1)),m(" "+n(s.pagePath),1)])):g("",!0),s.type==="faq"&&s.keywords?.length?(l(),r("div",re,[t[17]||(t[17]=e("span",{class:"font-semibold"},"Keywords:",-1)),m(" "+n(s.keywords.join(", ")),1)])):g("",!0),e("div",ne,"Delay: "+n(s.delayMs)+"ms | Priority: "+n(s.priority),1)]),e("td",ie,[e("button",{onClick:c=>V(s),class:R(["px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider transition-colors",s.isActive?"bg-green-100 text-green-700 hover:bg-green-200":"bg-red-100 text-red-700 hover:bg-red-200"])},n(s.isActive?"Active":"Inactive"),11,de)]),e("td",ue,[e("button",{onClick:c=>M(s),class:"p-2 text-gray-400 hover:text-blue-600 transition-colors bg-white rounded-lg border border-gray-100 shadow-sm hover:shadow"},[...t[18]||(t[18]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1)])],8,pe),e("button",{onClick:c=>D(s),class:"p-2 text-gray-400 hover:text-red-600 transition-colors bg-white rounded-lg border border-gray-100 shadow-sm hover:shadow"},[...t[19]||(t[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ce)])]))),128))])]))]),P(q,{show:x.value,title:k.value?"Edit Bot Configuration":"New Bot Configuration",onClose:t[10]||(t[10]=s=>x.value=!1)},{actions:w(()=>[e("button",{onClick:t[9]||(t[9]=s=>x.value=!1),class:"px-8 py-3 text-[10px] font-black uppercase tracking-widest text-gray-400 hover:text-black transition-colors"},"Cancel"),e("button",{onClick:T,class:"px-8 py-3 bg-black text-white text-[10px] font-black uppercase tracking-widest hover:bg-gray-800 transition-all rounded-lg"},n(k.value?"Save Changes":"Create Config"),1)]),default:w(()=>[e("div",ge,[e("div",be,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Key",-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.key=s),type:"text",placeholder:"e.g. welcome_msg",class:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-lg text-sm focus:outline-none focus:border-black focus:bg-white transition-all"},null,512),[[p,a.value.key]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Type",-1)),d(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.type=s),class:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-lg text-sm focus:outline-none focus:border-black focus:bg-white transition-all"},[...t[22]||(t[22]=[e("option",{value:"greeting"},"Greeting (Auto-open)",-1),e("option",{value:"page_trigger"},"Page Trigger",-1),e("option",{value:"faq"},"FAQ Response",-1),e("option",{value:"fallback"},"Fallback Match",-1)])],512),[[N,a.value.type]])])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Message",-1)),d(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.message=s),rows:"3",placeholder:"Bot response text...",class:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-lg text-sm focus:outline-none focus:border-black focus:bg-white transition-all resize-none"},null,512),[[p,a.value.message]])]),a.value.type==="page_trigger"?(l(),r("div",ye,[t[25]||(t[25]=e("label",{class:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Target Page Path",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>a.value.pagePath=s),type:"text",placeholder:"e.g. /programs",class:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-lg text-sm focus:outline-none focus:border-black focus:bg-white transition-all"},null,512),[[p,a.value.pagePath]])])):g("",!0),a.value.type==="faq"?(l(),r("div",xe,[t[26]||(t[26]=e("label",{class:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Keywords (comma-separated)",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.value.keywords=s),type:"text",placeholder:"e.g. about, who are you, panafstrag",class:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-lg text-sm focus:outline-none focus:border-black focus:bg-white transition-all"},null,512),[[p,a.value.keywords]])])):g("",!0),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Quick Replies (comma-separated)",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.value.quickReplies=s),type:"text",placeholder:"e.g. Tell me more, Contact Support",class:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-lg text-sm focus:outline-none focus:border-black focus:bg-white transition-all"},null,512),[[p,a.value.quickReplies]])]),e("div",ve,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Delay (ms)",-1)),d(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>a.value.delayMs=s),type:"number",class:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-lg text-sm focus:outline-none focus:border-black focus:bg-white transition-all"},null,512),[[p,a.value.delayMs,void 0,{number:!0}]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-[10px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Priority",-1)),d(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>a.value.priority=s),type:"number",class:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-lg text-sm focus:outline-none focus:border-black focus:bg-white transition-all"},null,512),[[p,a.value.priority,void 0,{number:!0}]])])])])]),_:1},8,["show","title"]),P(q,{show:v.value,title:"Confirm Deletion",onClose:t[12]||(t[12]=s=>v.value=!1)},{actions:w(()=>[e("button",{onClick:t[11]||(t[11]=s=>v.value=!1),class:"px-8 py-3 text-[10px] font-black uppercase tracking-widest text-gray-400 hover:text-black transition-colors"},"Cancel"),e("button",{onClick:U,class:"px-8 py-3 bg-red-600 text-white text-[10px] font-black uppercase tracking-widest hover:bg-red-700 transition-all rounded-lg"},"Delete")]),default:w(()=>[e("div",ke,[e("p",fe,[t[30]||(t[30]=m("Are you sure you want to delete the configuration ",-1)),e("strong",null,n(i.value?.key),1),t[31]||(t[31]=m("? This action cannot be undone.",-1))])])]),_:1},8,["show"])])}}});export{$e as default};
