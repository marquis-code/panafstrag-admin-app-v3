import{_ as G}from"./BAPEXAyc.js";import{_ as H,a as z}from"./DeZD_aI0.js";import{_ as W}from"./BUeb58OD.js";import{o as X,r as d,d as Y,a as Z,b as i,c,e,i as q,f as _,x as D,F as S,h as T,y as L,j as A,t as f,B as J,v as M,N as K,z as Q,n as ee}from"./BkOmVWpN.js";import{G as m,u as te}from"./Bmbvx39S.js";import{u as ae}from"./C-Y3-0Hx.js";import"./C_Yi8Lnb.js";import"./C1hZ1d1p.js";const h={getCurrent(){return m.get("/active-banner/current")},getAll(){return m.get("/active-banner")},getOne(r){return m.get(`/active-banner/${r}`)},create(r){return m.post("/active-banner",r)},update(r,v){return m.patch(`/active-banner/${r}`,v)},remove(r){return m.delete(`/active-banner/${r}`)}},se=()=>{const r=d(!1),v=d([]),k=d(null),u=d(null),x=async()=>{r.value=!0,u.value=null;try{const s=await h.getAll();return[200,201].includes(s?.status)&&(v.value=s.data?.data??s.data??[]),s}catch(s){u.value=s?.message||"Failed to fetch banners"}finally{r.value=!1}},C=async()=>{try{const s=await h.getCurrent();return[200,201].includes(s?.status)&&(k.value=s.data),s}catch(s){u.value=s?.message||"Failed to fetch active banner"}},E=async s=>{r.value=!0;try{const o=await h.create(s);return[200,201].includes(o?.status)&&await x(),o}catch(o){throw u.value=o?.message||"Failed to create banner",o}finally{r.value=!1}},y=async(s,o)=>{r.value=!0;try{const p=await h.update(s,o);return[200,201].includes(p?.status)&&await x(),p}catch(p){throw u.value=p?.message||"Failed to update banner",p}finally{r.value=!1}},g=async s=>{r.value=!0;try{const o=await h.remove(s);return[200,201].includes(o?.status)&&await x(),o}catch(o){throw u.value=o?.message||"Failed to delete banner",o}finally{r.value=!1}};return X(x),{loading:r,banners:v,activeBanner:k,error:u,fetchAll:x,fetchCurrent:C,createBanner:E,updateBanner:y,deleteBanner:g}},re={class:"space-y-12"},oe={key:0,class:"py-24 flex justify-center"},le={key:1},ne={key:2,class:"bg-white border border-gray-100 shadow-sm overflow-hidden"},ie={class:"overflow-x-auto"},ce={class:"w-full text-left border-collapse min-w-[800px]"},de={class:"divide-y divide-gray-100"},ue={class:"px-8 py-6"},pe={class:"flex items-center gap-4"},ge={class:"w-12 h-12 bg-gray-100 overflow-hidden border border-gray-100"},fe=["src"],ve=["src"],xe={key:2,class:"w-full h-full flex items-center justify-center text-[8px] font-black text-gray-300 uppercase"},be={class:"max-w-xs"},me={class:"font-black text-black uppercase tracking-tight line-clamp-1"},ye={class:"text-[9px] font-black text-gray-400 uppercase italic line-clamp-1"},he={class:"px-8 py-6"},ke={class:"text-[10px] font-black text-gray-400 uppercase tracking-widest"},we={class:"px-8 py-6"},_e={class:"text-[10px] font-black text-gray-400 uppercase tracking-widest"},De={class:"px-8 py-6"},Ae={class:"px-8 py-6 text-right"},Ce={class:"flex items-center justify-end gap-3"},Ee=["onClick"],Ie=["onClick"],Be={class:"space-y-12 py-4"},Ne={class:"space-y-6"},Se=["value"],Te={class:"grid md:grid-cols-2 gap-8"},Le={class:"flex items-center gap-4 pt-4"},Me={class:"relative inline-flex items-center cursor-pointer"},Oe={class:"text-[10px] font-black uppercase tracking-widest text-gray-400"},Re=["disabled"],ze=Y({__name:"active-banners",setup(r){const{banners:v,loading:k,createBanner:u,updateBanner:x,deleteBanner:C}=se(),{programs:E}=ae(),{showToast:y}=te(),g=d(!1),s=d(!1),o=d(null),p=d(!1),b=d(null),w=d(!1),n=Q({programId:"",startDate:"",endDate:"",isActive:!0}),O=()=>{b.value=null,Object.assign(n,{programId:"",startDate:"",endDate:"",isActive:!0}),g.value=!0},R=l=>{b.value=l._id,Object.assign(n,{programId:l.programId?._id||l.programId,startDate:l.startDate?new Date(l.startDate).toISOString().slice(0,16):"",endDate:l.endDate?new Date(l.endDate).toISOString().slice(0,16):"",isActive:l.isActive}),g.value=!0},V=async()=>{w.value=!0;try{b.value?await x(b.value,n):await u(n),g.value=!1,y({title:"Success",message:b.value?"Banner updated":"Banner created",toastType:"success",duration:3e3})}catch{y({title:"Error",message:"Operation failed",toastType:"error",duration:3e3})}finally{w.value=!1}},j=l=>{o.value=l,s.value=!0},U=async()=>{if(o.value){p.value=!0;try{await C(o.value),s.value=!1,y({title:"Success",message:"Banner removed",toastType:"success",duration:3e3})}finally{p.value=!1,o.value=null}}},N=l=>{const t=new Date,I=new Date(l.startDate),B=new Date(l.endDate);return l.isActive?t<I?{label:"SCHEDULED",class:"text-blue-500 border-blue-200"}:t>B?{label:"EXPIRED",class:"text-red-400 border-red-200"}:{label:"LIVE",class:"text-green-500 border-green-400"}:{label:"INACTIVE",class:"text-gray-400 border-gray-200"}};return Z({title:"Active Banners | PANAFSTRAG"}),(l,t)=>{const I=G,B=H,P=W,$=z;return i(),c("div",re,[e("div",{class:"flex flex-col md:flex-row md:items-end justify-between gap-6"},[t[7]||(t[7]=e("div",null,[e("p",{class:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-400 mb-2"},"Promotional Sector"),e("h1",{class:"text-4xl lg:text-6xl font-black tracking-tighter uppercase italic leading-none text-black"},[q(" Active "),e("span",{class:"not-italic text-gray-400 leading-none"},"Banners.")])],-1)),e("button",{onClick:O,class:"px-10 py-5 bg-black text-white font-black text-[10px] tracking-[0.3em] uppercase hover:bg-gray-800 active:scale-95 transition-all shadow-xl shadow-black/10"}," NEW BANNER ")]),_(k)?(i(),c("div",oe,[D(I)])):_(v)?.length?(i(),c("div",ne,[e("div",ie,[e("table",ce,[t[10]||(t[10]=e("thead",null,[e("tr",{class:"bg-gray-50 border-b border-gray-100"},[e("th",{class:"px-8 py-6 text-[10px] font-black uppercase tracking-widest text-gray-400"},"Program"),e("th",{class:"px-8 py-6 text-[10px] font-black uppercase tracking-widest text-gray-400"},"Start"),e("th",{class:"px-8 py-6 text-[10px] font-black uppercase tracking-widest text-gray-400"},"End"),e("th",{class:"px-8 py-6 text-[10px] font-black uppercase tracking-widest text-gray-400"},"Status"),e("th",{class:"px-8 py-6 text-[10px] font-black uppercase tracking-widest text-gray-400 text-right"},"Actions")])],-1)),e("tbody",de,[(i(!0),c(S,null,T(_(v),a=>(i(),c("tr",{key:a._id,class:"hover:bg-gray-50/50 transition-colors group"},[e("td",ue,[e("div",pe,[e("div",ge,[a.programId?.bannerImages?.length?(i(),c("img",{key:0,src:a.programId.bannerImages[0],class:"w-full h-full object-cover"},null,8,fe)):a.programId?.imageUrl?(i(),c("img",{key:1,src:a.programId.imageUrl,class:"w-full h-full object-cover"},null,8,ve)):(i(),c("div",xe,"NO IMG"))]),e("div",be,[e("p",me,f(a.programId?.title||"Unknown Program"),1),e("p",ye,f(a.programId?.theme||""),1)])])]),e("td",he,[e("p",ke,f(new Date(a.startDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}).toUpperCase()),1)]),e("td",we,[e("p",_e,f(new Date(a.endDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}).toUpperCase()),1)]),e("td",De,[e("span",{class:ee(["px-3 py-1 border text-[9px] font-black uppercase tracking-widest",N(a).class])},f(N(a).label),3)]),e("td",Ae,[e("div",Ce,[e("button",{onClick:F=>R(a),class:"p-2 hover:bg-black hover:text-white border border-transparent hover:border-black transition-all"},[...t[8]||(t[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1)])],8,Ee),e("button",{onClick:F=>j(a._id),class:"p-2 text-gray-300 hover:text-black hover:bg-white transition-all"},[...t[9]||(t[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Ie)])])]))),128))])])])])):(i(),c("div",le,[D(B,{title:"NO BANNERS",message:"No active program banners configured. Create one to promote a program on the homepage."})])),D(P,{show:g.value,title:b.value?"EDIT BANNER":"NEW BANNER",onClose:t[5]||(t[5]=a=>g.value=!1)},{actions:L(()=>[e("button",{onClick:t[4]||(t[4]=a=>g.value=!1),class:"px-10 py-5 text-[10px] font-black uppercase tracking-widest text-gray-400 hover:text-black transition-colors"},"ABORT"),e("button",{onClick:V,disabled:w.value||!n.programId,class:"px-12 py-5 bg-black text-white text-[10px] font-black uppercase tracking-widest hover:bg-gray-800 disabled:opacity-30 transition-all"},f(w.value?"PROCESSING...":"AUTHORIZE BANNER"),9,Re)]),default:L(()=>[e("div",Be,[e("section",Ne,[t[16]||(t[16]=e("h3",{class:"text-[10px] font-black uppercase tracking-[0.3em] text-gray-300 border-b border-gray-100 pb-2"},"Banner Configuration",-1)),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-[9px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Select Program",-1)),A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>n.programId=a),class:"w-full px-0 py-3 bg-transparent border-b border-gray-200 focus:border-black outline-none text-[10px] font-black tracking-widest uppercase"},[t[11]||(t[11]=e("option",{value:"",disabled:""},"SELECT A PROGRAM...",-1)),(i(!0),c(S,null,T(_(E),a=>(i(),c("option",{key:a._id,value:a._id},f(a.title),9,Se))),128))],512),[[J,n.programId]])]),e("div",Te,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-[9px] font-black uppercase tracking-widest text-gray-400 mb-2"},"Start Date & Time",-1)),A(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>n.startDate=a),type:"datetime-local",class:"w-full px-0 py-3 bg-transparent border-b border-gray-200 focus:border-black outline-none text-[10px] font-black tracking-widest uppercase"},null,512),[[M,n.startDate]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-[9px] font-black uppercase tracking-widest text-gray-400 mb-2"},"End Date & Time",-1)),A(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>n.endDate=a),type:"datetime-local",class:"w-full px-0 py-3 bg-transparent border-b border-gray-200 focus:border-black outline-none text-[10px] font-black tracking-widest uppercase"},null,512),[[M,n.endDate]])])]),e("div",Le,[e("label",Me,[A(e("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=a=>n.isActive=a),class:"sr-only peer"},null,512),[[K,n.isActive]]),t[15]||(t[15]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-200 after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-black"},null,-1))]),e("span",Oe,f(n.isActive?"ACTIVE":"INACTIVE"),1)])])])]),_:1},8,["show","title"]),D($,{show:s.value,title:"DELETE BANNER",message:"Are you sure you want to remove this banner? The associated program will no longer be promoted.",loading:p.value,onClose:t[6]||(t[6]=a=>s.value=!1),onConfirm:U},null,8,["show","loading"])])}}});export{ze as default};
